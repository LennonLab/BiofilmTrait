---
title: "Biofilm Traits - Supplementary"
author: "Jay T. Lennon"
date: "`r format(Sys.time(), '%d %B, %Y')`"
header-includes:
   - \usepackage{array}
output: pdf_document
geometry: margin=2.54cm
---

I tried to figure out how to cacluate 95% confidence intervals (CIs) for x-intercepts. 
That is, the 95% CIs for Psi stars, the minimim MPa for postive population growth rate. 
This can be done using the code below with the output from a simple linear regression. 
However, I spent too much time trying to figure out how to do this with output from 
a dummy variables mutliple regression.
Not sure it's possible without recoding everything from scratch.
In the end, I just used the summary statistics from the dummy variables regression to
make inference about strain effects and reported Psi stars without errors. 

# Calculate Psi stars and their 95% CIs
```{r}

NM.int <- OE.int + fit$coefficients[3]
NM.slp <- OE.slp + NM.int - fit$coefficients[4]

KBS0701.solo.star <- -NM.int/NM.slp
segments(x0 = NM.star, y0 = -3.3, x1 = NM.star, y1 = 0, col = "black", 
         lwd = 2.5, lty = 6, xpd = T)

OE.star <- -OE.int/OE.slp
segments(x0 = OE.star, y0 = -3.3, x1 = OE.star, y1 = 0, col = "black", 
         lwd = 2.5, lty = 4, xpd = T)

KBS0701.solo <- confint(nls(KBS0701.2$rate ~ beta * (KBS0701.2$MPa - x0), 
            start = c(beta = KBS0701.fit [[2]], x0 = -KBS0701.fit[[1]]/KBS0701.fit[[2]])))

KBS0701.0406 <- confint(nls(NM_Growth ~ beta * (NM_MPa - x0), 
            start = c(beta = fit[[2]], x0 = -fit[[1]]/fit[[2]])))

KBS0701.0407 <- confint(nls(NM_Growth ~ beta * (NM_MPa - x0), 
            start = c(beta = fit[[2]], x0 = -fit[[1]]/fit[[2]])))

# # Psi-stars and errors
# http://r.789695.n4.nabble.com/confidence-interval-or-error-of-x-intercept-of-a-linear-regression-td876616.html
# NM.star <- confint(nls(NM_Growth ~ beta * (NM_MPa - x0), 
#                   start = c(beta = fit[[2]], x0 = -fit[[1]]/fit[[2]])))
# 
# OE.star <- confint(nls(NM_Growth ~ beta * (NM_MPa - x0), 
#                   start = c(beta = fit[[4]], x0 = -fit[[3]]/fit[[4]])))
# 
# 
# NM.star <- confint(nls(NM_Growth ~ beta * (NM_MPa - x0), 
#                   start = c(beta = NM.slp, x0 = -NM.int/NM.slp))) 
```

# Calculate niche bredth and errors
```{r}
# Use sigma values (`b`) to estimate 'nb'
x.Rmax <- 0.5 # percent of Rmax defining niche breadth

NM.nb <- NM.sig * (-log10(x.Rmax))^(1/fit4@coef[5]) # niche breadth for NM
NM.nb.e <- NM.nb/(NM.sig/NM.sig.e) # SEM niche breadth for NM

OE.nb <- OE.sig * (-log10(x.Rmax))^(1/fit4@coef[5]) # niche breadth for OE
OE.nb.e <- OE.nb/(OE.sig/OE.sig.e) # SEM niche breadth for OE
```

